<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">

<h:head>
<meta charset="UTF-8"></meta>
<title>Оформление заказа</title>
<link rel="stylesheet" href="css/order.css"></link>
</h:head>

<h:body>
	<main>
	<h:form>
		<fieldset id="fieldset_main">
			<legend>
				<span id="coffeeShop">Coffee shop</span>
			</legend>
			<div id="top">
				<div id="top_left"><a href="#{appUrlStore.baseUrl}" title="Главная страница"><img src="image/coffeeShop.jpg" alt="icon (Coffee Shop)" /></a></div>
				<div id="top_right">
					<label>Кол-во заказов:
					<h:outputText value="#{databaseOperations.orderCount}" disabled="disabled" placeholder="0"></h:outputText>
					</label>
				</div>
			</div>
			<div id="bottom">
				<label>Выберети сорт кофе: 
				<h:selectOneMenu value="#{coffeeOrder.coffeeType}">
  					    <f:selectItems value="#{coffeeOrder.coffeeTypeMap}"/>
    					<f:ajax listener="#{coffeeOrder.coffeeTypeChanged}" render="totalCostValue"/>
				</h:selectOneMenu>   

				</label>					
				<br></br> <br></br>
				 <fieldset>
					 <legend>
						<span id="coffeeShop">ВНИМАНИЕ</span>
					</legend>
					<label>Вы можете заказать доставку (+5$ к стоимости заказа): 
						<h:selectOneRadio value="#{coffeeOrder.deliveryType}">
   							<f:selectItems value="#{coffeeOrder.coffeeDeliveryMap}"/>
    						<f:ajax listener="#{coffeeOrder.coffeeDeliveryChanged}" render="totalCostValue" />
						</h:selectOneRadio> 
					</label>
			 	</fieldset> 
				<br></br> 
				<label> Количество (в граммах): 
				 	<h:inputText id="weight" value="#{coffeeOrder.weight}" validatorMessage="Вес должен быть от 100 до 5000 грамм" >
			       		 <f:validateLongRange maximum="5000" minimum="100" />
					</h:inputText> 
					<h:message for="weight" style="color:red" />
				</label> 
				<br></br> <br></br>
				<label> Дата: 
					<h:inputText id="orderDate" value="#{coffeeOrder.orderDate}" converter="orderDateConverter" converterMessage="Некорректно задана дата">
					</h:inputText> 
					<h:message for="orderDate" style="color:red" />
				</label> 
				<br></br><br></br> 
				<label> Время доставки С: 
					<h:inputText id="startTime" binding="#{startDateComponent}" value="#{coffeeOrder.startTime}" converterMessage="Некорректно задано время">
			    	   <f:convertDateTime type="time" pattern="HH:mm"/>
					</h:inputText>
				</label> 
				<label> По: 
					<h:inputText id="endTime" value="#{coffeeOrder.endTime}" converterMessage="Некорректно задано время">
			       		<f:convertDateTime type="time" pattern="HH:mm"/>
				       	<f:validator validatorId="orderTimeRangeValidator" />
   						<f:attribute name="startDateComponent" value="#{startDateComponent}" />
					</h:inputText>
				</label> 
					<h:message for="startTime" style="color:red" />
					<h:message for="endTime" style="color:red" />
				<br></br>
				<br></br> 
				<label>Стоимость заказа: 
 					<h:outputText id="totalCostValue" value="#{coffeeOrder.totalCost}" disabled="disabled" placeholder="0"></h:outputText>
				</label>
				<label>$</label>
				<br></br> <br></br> 
					 <h:commandButton value="Оформить заказ" action="#{databaseOperations.addOrder(coffeeOrder)}" /> 
			</div>
		</fieldset>
	</h:form>
	</main>
</h:body>
</html>